#Модификация и Документирование Программного Обеспечения

## 1. Разработка Руководства Системному Программисту

В соответствии с требованиями ЕСПД (Единая система программной документации), разработано **Руководство системному программисту**. Документ предназначен для специалистов, осуществляющих сопровождение, настройку и модификацию программного обеспечения.

| Раздел Руководства | Содержание (на основе репозитория) |
| :--- | :--- |
| **1. Общие Сведения** | Назначение системы (Учет заявок на ремонт), используемые языки (Python), СУБД (PostgreSQL). |
| **2. Структура Программы** | Описание модулей: `main_app.py` (бизнес-логика), `database_module.py` (работа с БД), `gui.py` (пользовательский интерфейс), `import_data.py` (загрузка данных). |
| **3. Настройка ПО** | **Компоненты:** Python 3.x, `psycopg2`, PyQt5. **Конфигурация БД:** Параметры подключения к PostgreSQL (`dbname`, `user`, `password`, `host`, `port`) указаны в `database_module.py` [1]. |
| **4. Схема Базы Данных** | Описание таблиц, ключей и связей (см. `table.sql` [2] и `Diagram.jpg` [3]). |
| **5. Процедура Модификации** | Описание процесса внесения изменений, включая правила именования и комментирования (см. п. 4.2). |
| **6. Резервное Копирование** | Инструкция по использованию функции `backup_database` в `database_module.py` [1] для создания дампа БД. |

## 2. Предложения по Модификации Программного Обеспечения

На основе анализа существующей структуры, основным предложением по модификации является **расширение функционала управления запасами и поставщиками** для более эффективного учета ремонтных работ.

| Вариант Модификации | Описание |
| :--- | :--- |
| **1. Управление Поставщиками** | Добавление таблицы `suppliers` и модуля для регистрации поставщиков запчастей. Это позволит отслеживать, у кого были закуплены те или иные детали, и упростит процесс заказа. |
| **2. Учет Складских Запасов** | Добавление таблицы `parts` и модуля для учета наличия запчастей на складе. Это позволит оперативно проверять наличие нужных деталей при создании заявки и уменьшит время простоя. |
| **3. Отчет по Рентабельности** | Разработка нового отчета, который будет анализировать соотношение стоимости ремонта (`requests.cost`) и затрат на запчасти (`requests.repair_parts`) для оценки рентабельности. |

## 3. Добавление Нового Пользователя и Роли

### 3.1. Роль "Менеджер"

Роль **"Менеджер"** уже предусмотрена в системе (см. `table.sql` [2] и `main_app.py` [4]).

**Функционал Менеджера (согласно должностным инструкциям):**
1.  **Просмотр Отчетов:** Доступ к отчетам по загрузке мастеров (`get_master_load_report`) и отчету о выполненных заявках (`get_master_performance_report`).
2.  **Управление Заявками:** Возможность назначать мастеров на заявки и изменять их статус.
3.  **Контроль Доступа:** Ограниченный доступ к административным функциям (например, резервное копирование и управление пользователями ему недоступно).

### 3.2. Добавление Пользователя

Добавление нового пользователя с ролью "Менеджер" осуществляется через SQL-запрос к таблице `users` или через административный интерфейс (если он реализован).

```sql
INSERT INTO users (user_id, login, password_hash, role, fio, phone_number)
VALUES (
    (SELECT COALESCE(MAX(user_id), 0) + 1 FROM users),
    'new_manager',
    'hashed_password_for_manager', -- В реальной системе используется хэш
    'Менеджер',
    'Иванов Иван Иванович',
    '79001234567'
);
```

## 4. Качественные Характеристики Кода

Анализ исходного кода (`main_app.py`, `database_module.py`, `gui.py`) выявил следующие качественные характеристики:

| Характеристика | Оценка и Реализация |
| :--- | :--- |
| **Полнота Обработки Ошибочных Данных** | **Удовлетворительно.** В `database_module.py` реализована обработка ошибок подключения и выполнения запросов. В `gui.py` реализована проверка прав доступа и уведомление пользователя о запрещенных действиях через `QMessageBox`. |
| **Наличие Тестов** | **Недостаточно.** Отсутствуют выделенные файлы для модульного тестирования (например, с использованием `unittest` или `pytest`). В задании упоминается функциональное тестирование, но его протокол не представлен. |
| **Средства Контроля Корректности Входных Данных** | **Базовый уровень.** В `gui.py` реализована проверка ролей перед выполнением действий. В `import_data.py` реализована обработка `NULL` и ошибок парсинга дат. Отсутствует строгая валидация всех полей ввода в интерфейсе. |
| **Средства Восстановления при Сбоях** | **Присутствуют.** Реализована функция резервного копирования БД (`backup_database` в `database_module.py`), что является ключевым средством восстановления. |
| **Наличие Комментариев** | **Хорошо.** Комментарии используются для пояснения сложных SQL-запросов и логики, что соответствует требованию "Необходимо использовать комментарии для пояснения неочевидных фрагментов кода". |
| **Проверка Корректности Передаваемых Данных** | **Присутствует.** Например, в `main_app.py` функция `update_user_role` проверяет, что новая роль входит в список разрешенных (`allowed_roles`). |
| **Наличие Описаний Основных Функций** | **Хорошо.** Большинство функций в `main_app.py` и `database_module.py` имеют docstrings (строки документации), описывающие их назначение. |

